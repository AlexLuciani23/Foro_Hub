## Proyecto Foro Hub - Registro de Avances
Objetivo: Dise√±ar e implementar una API REST robusta, segura y escalable para un foro llamado Forohub.
Referencia: https://github.com/VictorRodriguezL/challenge-foro-alura.git (como ejemplo de estructura y buenas pr√°cticas) y Trello https://trello.com/b/9DeAlIsq
Avances:
 1. Dise√±o y Modelado:
     Entidades: Usuario (id, nombre, correo, contrase√±a, roles), T√≥pico (id, t√≠tulo, contenido, autor, fecha), Respuesta (id, contenido, autor, t√≥pico, fecha).
     Diagrama de Clases: [PENDIENTE - Mejorar diagrama con relaciones y cardinalidad]
     Endpoints REST: 
	GET /topicos/{topicoId}/respuestas (Ver las respuestas de un t√≥pico)
	GET /usuarios/{usuarioId}/respuestas (Ver todas las respuestas escritas por un usuario)
	DELETE /respuestas/{respuestaId} (Eliminar una respuesta)
	PUT /respuestas/{respuestaId} (Editar una respuesta)

	Roles y Permisos:Administrador:
	Usuarios: Crear, leer, actualizar, eliminar, bloquear/desbloquear, asignar roles.
	T√≥picos: Crear, leer, actualizar, eliminar.
	Respuestas: Crear, leer, actualizar, eliminar.
	Moderador:
	T√≥picos: Crear, leer, actualizar, eliminar, mover, cerrar.
	Respuestas: Crear, leer, actualizar, eliminar, marcar como inapropiadas.
	Usuario:
	T√≥picos: Crear, leer, editar y eliminar propios.
	Respuestas: Crear, leer, editar y eliminar propias.
 2. Implementaci√≥n de Entidades y Repositorios:
	Entidad Usuario: Implementada
	Repositorio Usuario: Implementado
	Entidad T√≥pico: Implementada
	Repositorio T√≥pico: Implementado
	Entidad Respuesta: Implementada
	Repositorio Respuesta: Implementado
   
 3. Implementaci√≥n de Controladores:
     [COMPLETADO] Crear controladores para Usuario, T√≥pico y Respuesta.
 4. Autenticaci√≥n y Seguridad (Spring Security):
     UserDetailsServiceImpl: Implementada (revisar manejo de roles)
     UserDetailsImpl: Implementada (revisar mapeo de atributos y l√≥gica adicional)
     [PENDIENTE] Configurar Spring Security para proteger endpoints y definir roles.
 5. Manejo de Errores:
     [PENDIENTE] Definir estrategia para manejar errores y excepciones.
	[PENDIENTE] Considerar la creaci√≥n de clases de excepci√≥n personalizadas.
 6. Pruebas:
     [PENDIENTE] Definir plan de pruebas unitarias e de integraci√≥n.
	[PENDIENTE] Implementar pruebas.
 7. Documentaci√≥n (Swagger):
     [PENDIENTE] Configurar Swagger para generar documentaci√≥n de la API.
 8. Despliegue:
     [PENDIENTE] Definir estrategia de despliegue.
 9. √Åreas de Mejora:
     [PENDIENTE] Identificar posibles mejoras o funcionalidades adicionales.



Dise√±o y modelacion
Dibujar Diagrama de Clases.
********
autenticacion y seguridad spring security

Configurar Spring Security para proteger endpoints y definir roles:
Considerar usar @Secured para una sintaxis m√°s concisa.
Centralizar definiciones de roles y permisos.
Optimizar obtenci√≥n de roles en UserDetailsServiceImpl con cach√©.
Agregar l√≥gica adicional en UserDetailsImpl para atributos espec√≠ficos.
Revisar configuraci√≥n general de Spring Security (autenticaci√≥n, CORS, sesiones).
Escribir pruebas de seguridad (unitarias e de integraci√≥n).
***********
MANEJO DE ERRORES
Definir estrategia para manejar errores y excepciones.
Considerar la creaci√≥n de clases de excepci√≥n personalizadas.
******************
PRUEBAS
Definir plan de pruebas unitarias e de integraci√≥n.
Implementar pruebas.
*********
DOCUMENTACION SWAGGER
Configurar Swagger para generar documentaci√≥n de la API.
***************
DESPLIEGUE
Definir estrategia de despliegue.
************
AREAS A MEJORAR
Identificar posibles mejoras o funcionalidades adicionales.

Prompt para proxima conversacion: 
Soy Alex, estamos trabajando en el proyecto "Foro Hub", una API REST para un foro. Ya hemos definido los endpoints, implementado las entidades, repositorios y controladores. 
Ahora necesitamos mejorar la configuraci√≥n de Spring Security para proteger los endpoints y gestionar los roles de forma eficiente. Tambi√©n debemos escribir pruebas de seguridad, definir una estrategia para el manejo de errores, implementar pruebas unitarias e de integraci√≥n, configurar Swagger y definir una estrategia de despliegue. 
¬øPuedes ayudarme con estas tareas?

xml
png
svg
html

*********************************************
Resumen del proyecto
Aqu√≠ tienes un resumen de lo que encontr√©:

Estructura del proyecto: El proyecto est√° bien organizado, con paquetes para entidades, controladores, repositorios y servicios.
Entidades: Las entidades Usuario, Topico y Respuesta est√°n bien definidas, con los atributos necesarios.
Controladores: Los controladores tienen los endpoints b√°sicos para gestionar las entidades.
Repositorios: Los repositorios utilizan Spring Data JPA para interactuar con la base de datos.
Seguridad: Veo que tienes una clase SecurityConfig y las clases UserDetailsServiceImpl y UserDetailsImpl, lo cual es un buen comienzo para implementar la seguridad.
Puntos a mejorar:

Diagrama de clases: Ser√≠a √∫til tener un diagrama de clases que muestre las relaciones entre las entidades y sus cardinalidades.
Autenticaci√≥n y autorizaci√≥n: La configuraci√≥n de Spring Security necesita ser completada para implementar el sistema de autenticaci√≥n basado en JWT que discutimos.
Manejo de errores: No veo una estrategia definida para manejar errores y excepciones.
Pruebas: Faltan pruebas unitarias e de integraci√≥n para asegurar la calidad del c√≥digo.
Swagger: No veo la configuraci√≥n de Swagger para generar documentaci√≥n de la API.

***********************************
Tarea Pendiente
Implementaci√≥n de Entidades y Repositorios:
Entidad Usuario: Implementada
Repositorio Usuario: Implementado
Entidad T√≥pico: Implementada
Repositorio T√≥pico: Implementado
Entidad Respuesta: Implementada
Repositorio Respuesta: Implementado
Implementaci√≥n de Controladores:
Controladores para Usuario, T√≥pico y Respuesta: Completados
Correcci√≥n de error en WebSecurityConfig:
Bean userDetailsService inyectado correctamente.
Creaci√≥n de la clase JwtUtils:
M√©todos para generar, obtener el nombre de usuario y validar tokens JWT implementados.
Dise√±o y Modelado:
Diagrama de Clases: Mejorar diagrama con relaciones y cardinalidad.(PENDIENTE AL FINAL)
Autenticaci√≥n y Seguridad (Spring Security):
Implementar autenticaci√≥n basada en JWT:
Elegir librer√≠a JWT: (jjwt) - ¬°Ya elegimos jjwt!
Crear clase JwtUtils: - ¬°Ya creada!
Crear filtro AuthTokenFilter: Para validar tokens en cada solicitud.
Configurar Spring Security: Para usar tokens JWT.
Definir roles y permisos: De forma eficiente.
Escribir pruebas de seguridad: (unitarias e de integraci√≥n).
Manejo de Errores:
Definir estrategia: Para manejar errores y excepciones.
Considerar clases de excepci√≥n personalizadas:
Pruebas:
Definir plan de pruebas: Unitarias e de integraci√≥n.
Implementar pruebas:
Documentaci√≥n (Swagger):
Configurar Swagger: Para generar documentaci√≥n de la API.
Despliegue:
Definir estrategia de despliegue:
√Åreas de Mejora:
Identificar posibles mejoras:
*************************************

Implementaci√≥n de Entidades y Repositorios:
Entidad Usuario: Implementada
Repositorio Usuario: Implementado
Entidad T√≥pico: Implementada
Repositorio T√≥pico: Implementado
Entidad Respuesta: Implementada
Repositorio Respuesta: Implementado
Implementaci√≥n de Controladores:
Controladores para Usuario, T√≥pico y Respuesta: Completados
Correcci√≥n de error en WebSecurityConfig:
Bean userDetailsService inyectado correctamente.
Creaci√≥n de la clase JwtUtils:
M√©todos para generar, obtener el nombre de usuario y validar tokens JWT implementados.
Creaci√≥n del filtro AuthTokenFilter:
Filtro para validar tokens JWT en cada solicitud implementado.
Configuraci√≥n de Spring Security:
Spring Security configurado para usar tokens JWT en la autenticaci√≥n y autorizaci√≥n.
TAREAS PENDIENTE
Dise√±o y Modelado:
Diagrama de Clases: Mejorar diagrama con relaciones y cardinalidad.
Autenticaci√≥n y Seguridad (Spring Security):
Definir roles y permisos: De forma eficiente.
Escribir pruebas de seguridad: (unitarias e de integraci√≥n).
Manejo de Errores:
Definir estrategia: Para manejar errores y excepciones.
Considerar clases de excepci√≥n personalizadas:
Pruebas:
Definir plan de pruebas: Unitarias e de integraci√≥n.
Implementar pruebas:
Documentaci√≥n (Swagger):
Configurar Swagger: Para generar documentaci√≥n de la API.
Despliegue:
Definir estrategia de despliegue:
√Åreas de Mejora:
Identificar posibles mejoras: O funcionalidades adicionales.
***************************************************************
¬°Excelente, Alex! Me alegra que te guste la propuesta de roles y permisos.

Implementaci√≥n de Entidades y Repositorios:
Entidad Usuario: Implementada
Repositorio Usuario: Implementado
Entidad T√≥pico: Implementada
Repositorio T√≥pico: Implementado
Entidad Respuesta: Implementada
Repositorio Respuesta: Implementado
Implementaci√≥n de Controladores:
Controladores para Usuario, T√≥pico y Respuesta: Completados
Correcci√≥n de error en WebSecurityConfig:
Bean userDetailsService inyectado correctamente.
Creaci√≥n de la clase JwtUtils:
M√©todos para generar, obtener el nombre de usuario y validar tokens JWT implementados.
Creaci√≥n del filtro AuthTokenFilter:
Filtro para validar tokens JWT en cada solicitud implementado.
Configuraci√≥n de Spring Security:
Spring Security configurado para usar tokens JWT en la autenticaci√≥n y autorizaci√≥n.
Definici√≥n de roles y permisos:
Roles: ROLE_ADMIN, ROLE_MODERATOR, ROLE_USER.
Permisos: CREAR_TOPICO, EDITAR_TOPICO, ELIMINAR_TOPICO, CREAR_RESPUESTA, EDITAR_RESPUESTA, ELIMINAR_RESPUESTA, GESTIONAR_USUARIOS.
Verificaci√≥n del repositorio de GitHub:
El repositorio est√° actualizado con los cambios realizados.
Dise√±o y Modelado:
Diagrama de Clases: Mejorar diagrama con relaciones y cardinalidad.
Autenticaci√≥n y Seguridad (Spring Security):
Implementar roles y permisos en el c√≥digo:
Agregar roles a la entidad Usuario.
Verificar permisos en los controladores usando anotaciones como @PreAuthorize.
Escribir pruebas de seguridad: (unitarias e de integraci√≥n).
Manejo de Errores:
Definir estrategia: Para manejar errores y excepciones.
Considerar clases de excepci√≥n personalizadas:
****************************************************************
Implementaci√≥n de Entidades y Repositorios (09/07/2024)

Entidad Usuario: Implementada.
Repositorio Usuario: Implementado.
Entidad T√≥pico: Implementada.
Repositorio T√≥pico: Implementado.
Entidad Respuesta: Implementada.
Repositorio Respuesta: Implementado.
Entidad Comentario: Implementada.
Repositorio Comentario: Implementado.
Entidad Rol: Implementada.
Repositorio Rol: Implementado.
Enum EstadoTopico: Implementado.
Implementaci√≥n de Controladores (09/07/2024)

Controladores para Usuario, T√≥pico, Respuesta, Comentario y Rol: Completados.
Autenticaci√≥n y Seguridad (Spring Security) (09/07/2024)

Correcci√≥n de error en WebSecurityConfig: Bean userDetailsService inyectado correctamente.
Creaci√≥n de la clase JwtUtils: M√©todos para generar, obtener el nombre de usuario y validar tokens JWT implementados.
Creaci√≥n del filtro AuthTokenFilter: Filtro para validar tokens JWT en cada solicitud implementado.
Configuraci√≥n de Spring Security: Spring Security configurado para usar tokens JWT en la autenticaci√≥n y autorizaci√≥n.
Implementaci√≥n de @PreAuthorize en todos los controladores: Se ha agregado la anotaci√≥n para controlar los permisos de acceso a los m√©todos de los controladores.
Panel de Administraci√≥n (09/07/2024)

Creaci√≥n del controlador AdminController: Se ha creado el controlador para manejar las solicitudes del panel de administraci√≥n.
Implementaci√≥n del m√©todo listarUsuarios: Se ha implementado el m√©todo para obtener y mostrar la lista de usuarios.
Creaci√≥n de la vista listarUsuarios.html: Se ha creado la vista para mostrar la lista de usuarios en una tabla, incluyendo enlaces para asignar y eliminar roles.
*************************************************
10/07/2024 ACTUALIZADO TAREA PENDIENTE
Dise√±o y Modelado:
Diagrama de Clases: Mejorar diagrama con relaciones y cardinalidad.
Autenticaci√≥n y Seguridad (Spring Security):
Asignar roles a usuarios: Implementar la l√≥gica para que los administradores puedan asignar roles a los usuarios a trav√©s del panel de administraci√≥n.
Escribir pruebas de seguridad: (unitarias e de integraci√≥n) para verificar que la autorizaci√≥n funciona correctamente.
Manejo de Errores:
Definir estrategia: Para manejar errores y excepciones de forma consistente en toda la aplicaci√≥n.
Considerar clases de excepci√≥n personalizadas: Para manejar errores espec√≠ficos de tu aplicaci√≥n.
Pruebas:
Definir plan de pruebas: Unitarias e de integraci√≥n para asegurar la calidad del c√≥digo.
Implementar pruebas: Para los controladores, servicios y otras partes de la aplicaci√≥n.
Documentaci√≥n (Swagger):
Configurar Swagger: Para generar documentaci√≥n de la API y facilitar su uso.
Despliegue:
Definir estrategia de despliegue: Para poner la aplicaci√≥n en producci√≥n.
√Åreas de Mejora:
Identificar posibles mejoras: O funcionalidades adicionales que podr√≠an agregarse al proyecto.
Panel de Administraci√≥n:
Implementar funcionalidades adicionales: Asignar y eliminar roles a usuarios, gestionar t√≥picos y respuestas, etc.
*******************************************
11/07/2024 ACTUALIZADO TAREA PENDIENTES
Asignaci√≥n de Roles (Hoy):

Crear endpoints en AdminController para asignar y quitar roles a usuarios (ej. POST /usuarios/{userId}/roles/{roleId}).//
Implementar la l√≥gica para actualizar la relaci√≥n entre usuarios y roles en la base de datos.
Validar que solo administradores puedan realizar estas operaciones.
Manejo de Errores (Ma√±ana):

Definir una estrategia clara para manejar errores y excepciones.
Crear clases de excepci√≥n personalizadas para errores espec√≠ficos de la aplicaci√≥n (ej. RecursoNoEncontradoException, ErrorDeValidacionException).
Implementar un controlador global de excepciones (@ControllerAdvice) con m√©todos @ExceptionHandler para manejar los diferentes tipos de errores.
Devolver respuestas HTTP adecuadas (400, 404, 403, 500, etc.).
Tareas Secundarias (Pasado Ma√±ana):

Pruebas Unitarias e de Integraci√≥n:
Definir un plan de pruebas para cubrir los controladores, servicios y otras partes cr√≠ticas de la aplicaci√≥n.
Implementar las pruebas utilizando frameworks como JUnit y Mockito.
Asegurar que la autorizaci√≥n funciona correctamente y que los usuarios solo pueden acceder a las funcionalidades permitidas seg√∫n su rol.
Tareas Opcionales (Si queda tiempo):

Diagrama de Clases: Mejorar el diagrama con relaciones y cardinalidad.
Documentaci√≥n (Swagger): Configurar Swagger para generar documentaci√≥n de la API.
***************************************************************
PROYECTO FORO HUB REGISTRO AVANCES DETALLADO(10/07/2024-11/07/2024)Implementaci√≥n de Entidades y Repositorios (09/07/2024)
TAREA COMPLETADA
Entidad Usuario: Implementada.
Repositorio Usuario: Implementado.
Entidad T√≥pico: Implementada.
Repositorio T√≥pico: Implementado.
Entidad Respuesta: Implementada.
Repositorio Respuesta: Implementado.
Entidad Comentario: Implementada.
Repositorio Comentario: Implementado.
Entidad Rol: Implementada.
Repositorio Rol: Implementado.
Enum EstadoTopico: Implementado.
Implementaci√≥n de Controladores (09/07/2024)

Controladores para Usuario, T√≥pico, Respuesta, Comentario y Rol: Completados.
Autenticaci√≥n y Seguridad (Spring Security) (09/07/2024 - 11/07/2024)

Correcci√≥n de error en WebSecurityConfig: Bean userDetailsService inyectado correctamente.
Creaci√≥n de la clase JwtUtils: M√©todos para generar, obtener el nombre de usuario y validar tokens JWT implementados.
Creaci√≥n del filtro AuthTokenFilter: Filtro para validar tokens JWT en cada solicitud implementado.
Configuraci√≥n de Spring Security: Spring Security configurado para usar tokens JWT en la autenticaci√≥n y autorizaci√≥n.
Implementaci√≥n de @PreAuthorize en todos los controladores: Se ha agregado la anotaci√≥n para controlar los permisos de acceso a los m√©todos de los controladores.
Asignar roles a usuarios: Se implement√≥ la l√≥gica en el AdminController para asignar y quitar roles a los usuarios a trav√©s de los endpoints /usuarios/{usuarioId}/roles/{rolId} POST y DELETE y etc
*******************************************************
TAREAS COMPLETADAS
‚úÖ Asignaci√≥n de Roles:
‚úÖ Crear endpoints en AdminController para asignar y quitar roles a usuarios.
‚úÖ Implementar la l√≥gica para actualizar la relaci√≥n entre usuarios y roles en la base de datos.
‚úÖ Validar que solo administradores puedan realizar estas operaciones.
‚úÖ Manejo de Errores:
‚úÖ Definir una estrategia clara para manejar errores y excepciones.
‚úÖ Crear clases de excepci√≥n personalizadas para errores espec√≠ficos de la aplicaci√≥n.
‚úÖ Implementar un controlador global de excepciones (@ControllerAdvice) con m√©todos @ExceptionHandler.
‚úÖ Devolver respuestas HTTP adecuadas (400, 404, 403, 500, etc.).
‚úÖ Pruebas Unitarias para UsuarioService.crearUsuario:
‚úÖ Crear la clase de prueba UsuarioServiceTest.
‚úÖ Escribir la prueba crearUsuario_deberiaGuardarUsuarioEnRepositorio.
‚úÖ Utilizar Mockito para crear un mock de UsuarioRepository.
‚úÖ Verificar que el m√©todo save del repositorio se llama correctamente.

TAREAS PRIORITARIAS
üö® Ejecutar Pruebas:
Ejecutar la prueba crearUsuario_deberiaGuardarUsuarioEnRepositorio y analizar los resultados.
üö® Escribir m√°s Pruebas Unitarias:
Dise√±ar e implementar pruebas para otras funcionalidades cr√≠ticas de la aplicaci√≥n, como:
Registro y autenticaci√≥n de usuarios.
Creaci√≥n y gesti√≥n de t√≥picos.
Publicaci√≥n y gesti√≥n de respuestas.
Comentarios.
Roles y permisos.

TAREAS SECUNDARIAS
Diagrama de Clases: Mejorar el diagrama con relaciones y cardinalidad.
Documentaci√≥n (Swagger): Configurar Swagger para generar documentaci√≥n de la API.
Despliegue: Definir una estrategia de despliegue para poner la aplicaci√≥n en producci√≥n.

**********************************************
Avances:12/07/2024

Entidades, Repositorios y Controladores: Implementados.
Autenticaci√≥n y Seguridad (Spring Security): Implementada autenticaci√≥n basada en JWT, roles y permisos definidos.
Manejo de Errores: Implementadas excepciones personalizadas y un controlador global de excepciones.

TAREA PENDIENTE
Escribir Pruebas Unitarias e de Integraci√≥n:
Dise√±ar e implementar pruebas para cubrir todas las funcionalidades cr√≠ticas de la aplicaci√≥n, incluyendo registro y autenticaci√≥n de usuarios, creaci√≥n y gesti√≥n de t√≥picos, publicaci√≥n y gesti√≥n de respuestas, comentarios, y roles y permisos.
Utilizar frameworks como JUnit y Mockito para las pruebas.
Asegurar que la autorizaci√≥n funciona correctamente y que los usuarios solo pueden acceder a las funcionalidades permitidas seg√∫n su rol.
PRIORIDAD MEDIA 
Documentaci√≥n (Swagger):
Configurar Swagger para generar documentaci√≥n de la API y facilitar su uso por parte de otros desarrolladores.
Diagrama de Clases:

Mejorar el diagrama de clases con relaciones y cardinalidad para una mejor visualizaci√≥n de la estructura de la aplicaci√≥n.
Despliegue:

Definir una estrategia de despliegue para poner la aplicaci√≥n en producci√≥n (por ejemplo, en un servidor en la nube).
√Åreas de Mejora:

Identificar posibles mejoras o funcionalidades adicionales que podr√≠an agregarse al proyecto.
